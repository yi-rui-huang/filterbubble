<template>
  <div class="page-container">
    <!-- Left Column: Agent Profiles -->
    <div class="sidebar agent-profiles-sidebar">
      <h3 class="sidebar-title">Film Discussion Agents</h3>
      <div class="agent-list">
        <div 
          v-for="(agent, key) in agentProfiles.agents" 
          :key="key" 
          class="agent-profile-card"
          @click="setActiveAgent(key)"
          :class="{'active': activeAgent === key}"
        >
          <div class="agent-avatar-container">
            <img :src="getAgentAvatar(key)" class="agent-profile-avatar" alt="Agent Avatar">
          </div>
          <div class="agent-info">
            <h4 class="agent-role">{{ agent.role }}</h4>
            <p class="agent-description">{{ agent.description }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Middle Column: Conversation -->
    <div class="conversation-container">
      <div class="card conversation-card">
        <h2 class="card-title">Second Conversation Round</h2>
        <p class="conversation-description">
          In this section, you will have another conversation with an AI assistant. This time, the AI might
          respond differently based on your previous interactions. Feel free to explore new topics or
          continue previous discussions.
        </p>
        
        <div class="conversation-area">
          <div class="messages-container" ref="messagesContainer">
            <div 
              v-for="(message, index) in messages" 
              :key="index" 
              :class="['message', message.sender === 'user' ? 'user-message' : `agent-message ${message.agentType || 'default-agent'}-message`]"
              @click="message.sender === 'agent' ? replyToAgent(message.agentType, $event) : null"
              :style="message.sender === 'agent' ? 'cursor: pointer;' : ''"
            >
              <div v-if="message.sender === 'agent'" class="agent-avatar">
                <img :src="getAgentAvatar(message.agentType)" alt="Agent Avatar" class="avatar-image">
              </div>
              <div class="message-content">
                <div v-if="message.sender === 'agent'" class="agent-message-container">
                  <div :class="['agent-message-text', message.isMinimized ? 'minimized' : '']">
                    <p>{{ message.text }}</p>
                  </div>
                  <div class="message-actions" v-if="message.sender === 'agent'">
                    <button class="toggle-btn" @click.stop="toggleMessageView(index)">
                      {{ message.isMinimized ? 'more' : 'less' }}
                    </button>
                  </div>
                  <div class="mentioned-movies" v-if="message.mentionedMovies && message.mentionedMovies.length > 0">
                    <h4>Mentioned Movies:</h4>
                    <ul class="movie-list-compact">
                      <li v-for="(movie, movieIndex) in message.mentionedMovies" :key="movieIndex">
                        <strong>{{ movie.title }}</strong> - {{ movie.description }}
                      </li>
                    </ul>
                  </div>
                </div>
                <p v-else>{{ message.text }}</p>
                <span class="message-time">{{ formatTime(message.timestamp) }}</span>
                <span v-if="message.sender === 'agent'" class="reply-hint">点击回复 (按住Shift键可@多个)</span>
              </div>
            </div>
            
            <div v-if="isAgentTyping" class="message agent-message typing-indicator">
              <div class="typing-dots">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>
          </div>
          
          <div class="input-area">
            <textarea 
              v-model="userInput" 
              placeholder="Type your message here..." 
              class="message-input"
              @keydown.enter.prevent="sendMessage"
              :disabled="isSubmitting"
              ref="messageInput"
            ></textarea>
            <button 
              class="btn send-btn" 
              @click="sendMessage" 
              :disabled="!userInput.trim() || isSubmitting"
            >
              Send
            </button>
          </div>
        </div>
        
        <div class="conversation-actions">
          <p class="messages-remaining" v-if="remainingMessages > 0">
            {{ remainingMessages }} messages remaining before you can proceed
          </p>
          <button 
            class="btn next-btn" 
            @click="finishConversation" 
            :disabled="!canProceed"
          >
            Complete Second Round
          </button>
        </div>
      </div>
    </div>

    <!-- Right Column: Movie Recommendations -->
    <div class="sidebar movie-recommendations-sidebar">
      <h3 class="sidebar-title">Movie Recommendations</h3>
      <div class="movie-list">
        <div v-if="recommendedMovies.length === 0" class="no-recommendations">
          <p>Agents will recommend movies as you chat with them.</p>
          <!-- Example recommendations - commented out as requested
          <div class="example-recommendation">
            <div class="example-movie-card">
              <h4 class="movie-title">The Shawshank Redemption</h4>
              <p class="movie-recommender">Recommended by: Agent</p>
              <p class="movie-reason">Its powerful storytelling and emotional depth make it a timeless classic.</p>
            </div>
            <div class="example-movie-card">
              <h4 class="movie-title">Inception</h4>
              
              <p class="movie-recommender">Recommended by: Agent</p>
              <p class="movie-reason">The complex narrative structure and visual effects create a unique cinematic experience.</p>
            </div>
            <div class="example-movie-card">
              <h4 class="movie-title">The Avengers</h4>
              <p class="movie-recommender">Recommended by: Agent</p>
              <p class="movie-reason">It perfectly balances action, humor, and character development in an entertaining package.</p>
            </div>
          </div>
          -->
        </div>
        <div 
          v-for="(movie, index) in recommendedMovies" 
          :key="index" 
          class="movie-card"
          :class="`recommended-by-${movie.recommendedBy}`"
        >
          <h4 class="movie-title">{{ movie.title }}</h4>
          <p class="movie-recommender">Recommended by: {{ agentProfiles.agents[movie.recommendedBy]?.role || 'Agent' }}</p>
          <p class="movie-reason" v-if="movie.reason">{{ movie.reason }}</p>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import axios from 'axios';
import agentProfiles from '../data/agent_profiles.json';
import { logConversation, logUserEvent } from '../services/loggingService';
import { analyzeRelevance, detectEmotion } from '../services/analysisService';
import p1Image from '../images/p1.png';
import p2Image from '../images/p2.png';
import p3Image from '../images/p3.png';
import p4Image from '../images/p4.png';

// Configuration for GPT-4o API
const API_KEY = 'sk-SE3cDjGLJoAcscUqzyfVELo1yNnrxgJ18jFkhcwwhTqqUJUn';
const BASE_URL = 'https://api.tao-shen.com/v1';
const MODEL = 'gpt-4o';
const API_TIMEOUT = 30000; // 30秒超时

// 备用API配置，如果主API失败，可以尝试使用备用API
const BACKUP_API_KEY = 'sk-SE3cDjGLJoAcscUqzyfVELo1yNnrxgJ18jFkhcwwhTqqUJUn';
const BACKUP_BASE_URL = 'https://api.tao-shen.com/v1';

export default {
  name: 'SecondRoundConversation',
  data() {
    return {
      userInput: '',
      messages: [],
      isAgentTyping: false,
      isSubmitting: false,
      minRequiredMessages: 5, // Minimum number of user messages required
      maxMessages: 30, // Maximum number of messages allowed
      welcomeMessage: "", // Empty as we now use a full welcome message in created()
      activeAgent: null, // Currently selected agent in the sidebar
      recommendedMovies: [], // List of movies recommended by agents
      agentProfiles: agentProfiles // Import the agent profiles data
    };
  },
  computed: {
    userMessageCount() {
      return this.messages.filter(m => m.sender === 'user').length;
    },
    remainingMessages() {
      return Math.max(this.minRequiredMessages - this.userMessageCount, 0);
    },
    canProceed() {
      return this.userMessageCount >= this.minRequiredMessages;
    }
  },
  created() {
    // Log page view
    logUserEvent('view_second_round_conversation');
    
    // Add welcome message
    this.addMessage({
      sender: 'agent',
      agentType: 'moderator',
      text: "Welcome back to our film discussion! I'm your moderator, and I'm joined by our panel of film experts. Feel free to ask questions or share your thoughts on any movies you've seen recently. You can also direct your questions to specific agents by using @critic, @fan, or @analyst.",
      timestamp: new Date(),
      isMinimized: false,
      mentionedMovies: []
    });

    
    // Add introductions from each agent
    this.addAgentIntroductions();
    
    // Load agent profiles
    console.log('Agent profiles loaded:', this.agentProfiles);
    
    // Log agent welcome message
    try {
      logConversation('2', 'agent', "Welcome back to our film discussion! I'm your moderator, and I'm joined by our panel of film experts. Feel free to ask questions or share your thoughts on any movies you've seen recently. You can also direct your questions to specific agents by using @critic, @fan, or @analyst.", 'moderator');
    } catch (error) {
      console.warn('Failed to log agent welcome message to Firebase:', error);
    }
    
    // 验证API密钥
    this.validateApiKey();
  },
  mounted() {
    // Focus the input field
    this.$refs.messageInput.focus();
  },
  methods: {
    async sendMessage() {
      console.log('Starting sendMessage process...');
      if (!this.userInput.trim() || this.isSubmitting) {
        return;
      }

      this.isSubmitting = true;
      const userMessage = this.userInput.trim();
      this.userInput = '';

      // Add user message to conversation
      this.addMessage({
        sender: 'user',
        text: userMessage,
        timestamp: new Date(),
        isMinimized: false,
        mentionedMovies: []
      });
      console.log('User message added to conversation');

      // Log user message to Firebase
      try {
        await logConversation('2', 'user', userMessage);
        console.log('User message logged to Firebase');
      } catch (error) {
        console.warn('Failed to log user message to Firebase:', error);
      }

      // Check if maximum messages reached
      if (this.messages.length >= this.maxMessages * 2) { // *2 because each exchange has 2 messages
        console.log(`Maximum messages reached (${this.messages.length}/${this.maxMessages * 2}), stopping`);
        this.isSubmitting = false;
        return;
      } else {
        console.log(`Current message count: ${this.messages.length}/${this.maxMessages * 2}`);
      }

      // Simulate agent typing
      this.isAgentTyping = true;
      console.log('Agent typing indicator shown');

      try {
        // Analyze user input for relevance and emotion
        console.log('Analyzing user input...');
        const relevanceScores = analyzeRelevance(agentProfiles.agents, userMessage);
        const userEmotion = detectEmotion(userMessage);
        console.log('User emotion detected:', userEmotion);
        console.log('Relevance scores:', relevanceScores);
        
        // Get previous agent memories if they exist
        const agentMemories = this.getAgentMemories();

        // Determine if this is a direct response to specific agents
        const targetedAgents = this.detectTargetedAgents(userMessage);
        
        // Select agents for this round of discussion
        let selectedAgents;
        
        if (targetedAgents.length > 0) {
          // If user is responding to specific agents, prioritize those agents
          selectedAgents = targetedAgents;
          
          // Add moderator and one other relevant agent
          const otherAgents = Object.keys(agentProfiles.agents)
            .filter(a => !targetedAgents.includes(a) && a !== 'moderator')
            .sort((a, b) => relevanceScores[b] - relevanceScores[a])
            .slice(0, 1);
            
          selectedAgents = [...selectedAgents, ...otherAgents, 'moderator'];
        } else {
          // Sort agents by relevance and select top agents
          selectedAgents = Object.keys(agentProfiles.agents)
            .sort((a, b) => relevanceScores[b] - relevanceScores[a])
            .slice(0, 3); // Limit to top 3 agents
            
          // Ensure moderator is included in important discussions
          if (this.messages.length % 6 === 0 && !selectedAgents.includes('moderator')) {
            selectedAgents[selectedAgents.length - 1] = 'moderator';
          }
        }

        console.log('Final selected agents for response:', selectedAgents);

        // Build conversation history with previous messages
        let conversationHistory = this.buildConversationHistory();
        
        // Add current user message
        conversationHistory += `\nUser: ${userMessage}`;
        
        // For each selected agent, generate a response
        for (const agentKey of selectedAgents) {
          const agentProfile = agentProfiles.agents[agentKey];
          const agentMemory = agentMemories[agentKey] || [];
          
          const headers = {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${API_KEY}`
          };
          
          // Build a more sophisticated prompt that includes:
          // 1. The agent's role and expertise
          // 2. The agent's memory of previous interactions
          // 3. The current conversation history
          // 4. Instructions for interaction with other agents
          
          let agentContext = '';
          
          // Add agent's memory of previous interactions
          if (agentMemory.length > 0) {
            agentContext += `\nPrevious interactions with the user:\n${agentMemory.join('\n')}\n`;
          }
          
          // Add special instructions based on agent role
          if (agentKey === 'moderator') {
            agentContext += `\nAs the moderator, your role is to guide the discussion, ask follow-up questions, and ensure all perspectives are heard. If the conversation has been going on for a while, consider summarizing key points.`;
          } else if (targetedAgents.includes(agentKey)) {
            agentContext += `\nThe user is directly responding to your previous comment. Address their feedback specifically.`;
          }
          
          const prompt = 
            `${conversationHistory}\n\n${agentContext}\n\nAs a ${agentProfile.role}, with expertise in ${agentProfile.knowledge_domains.join(', ')}, engage in a natural discussion about movies. Respond to previous comments from other participants, and if appropriate, recommend movies that align with your perspective. Keep your response conversational and engaging.`;
          
          const data = {
            model: MODEL,
            messages: [{
              role: 'user',
              content: prompt
            }],
            max_tokens: 500 // Increased token limit for more meaningful responses
          };

          console.log(`Sending API request for ${agentProfile.role}...`);
          try {
            console.log(`API request details: URL=${BASE_URL}/chat/completions, model=${MODEL}`);
            const response = await axios.post(`${BASE_URL}/chat/completions`, data, { headers, timeout: API_TIMEOUT });
            console.log(`Received API response for ${agentProfile.role}:`, response.status);
            const agentResponse = response.data.choices[0].message.content;
            
            // Check if the response already starts with the agent's role
            let displayText = '';
            if (agentResponse.startsWith(agentProfile.role + ':') || 
                agentResponse.startsWith(agentProfile.role + ' :')) {
              displayText = agentResponse;
            } else {
              displayText = `${agentProfile.role}: ${agentResponse}`;
            }
            
            // Add the full message with the agent role if it was extracted
            this.addMessage({
              sender: 'agent',
              agentType: agentKey,
              text: displayText,
              timestamp: new Date(),
              isMinimized: false,
              mentionedMovies: this.extractMovieMentions(displayText)
            });
            
            // Log agent message to Firebase
            try {
              await logConversation('2', 'agent', agentResponse, agentKey);
            } catch (error) {
              console.warn('Failed to log agent message to Firebase:', error);
            }
            
            // Update agent memory with this interaction
            this.updateAgentMemory(agentKey, userMessage, agentResponse);
            
            // Update conversation history
            conversationHistory += `\n${agentProfile.role}: ${agentResponse}`;
          } catch (error) {
            console.error(`Error generating response for ${agentProfile.role}:`, error);
            console.error('Error details:', error.response ? error.response.data : 'No response data');
            
            // Try using backup API
            if (error.response && error.response.status === 401) {
              console.log('Trying backup API...');
              headers.Authorization = `Bearer ${BACKUP_API_KEY}`;
              const backupResponse = await axios.post(`${BACKUP_BASE_URL}/chat/completions`, data, { headers, timeout: API_TIMEOUT });
              if (backupResponse.data && backupResponse.data.choices && backupResponse.data.choices.length > 0) {
                console.log('Backup API response received');
                const backupAgentResponse = backupResponse.data.choices[0].message.content;
                this.addMessage({
                  sender: 'agent',
                  agentType: agentKey,
                  text: backupAgentResponse,
                  timestamp: new Date(),
                  isMinimized: false,
                  mentionedMovies: this.extractMovieMentions(backupAgentResponse)
                });
              } else {
                console.error('Backup API response invalid:', backupResponse.data);
              }
            } else {
              // Add a fallback message for this specific agent
              this.addMessage({
                sender: 'agent',
                agentType: agentKey,
                text: `${agentProfile.role}: I'm having trouble formulating my thoughts right now. Let me think about this...`,
                timestamp: new Date()
              });
            }
            
            // Add a small delay between agent responses to make it feel more natural
            await new Promise(resolve => setTimeout(resolve, 1000));
          }
        }
        
        // If this is a longer conversation, occasionally have agents respond to each other
        if (this.messages.length > 6 && Math.random() > 0.5) {
          console.log('Triggering agent-to-agent response...');
          await this.generateAgentToAgentResponse(conversationHistory, selectedAgents);
        } else {
          console.log('Not triggering agent-to-agent response. Messages length:', this.messages.length);
        }
      } catch (error) {
        console.error('Error calling GPT-4o API:', error);
        if (error.response) {
          console.error('API error response:', error.response.status, error.response.data);
        } else if (error.request) {
          console.error('No response received from API:', error.request);
        } else {
          console.error('Error setting up API request:', error.message);
        }
        
        // Add a fallback message if API call fails
        this.addMessage({
          sender: 'agent',
          agentType: 'moderator',
          text: "Moderator: I apologize, but I'm having trouble connecting to our discussion system. Please try again in a moment.",
          timestamp: new Date()
        });
      } finally {
        this.isAgentTyping = false;
        this.isSubmitting = false;
      }
    },
    addMessage(message) {
      // If this is an agent message, extract movie mentions and set initial state
      if (message.sender === 'agent') {
        message.mentionedMovies = this.extractMovieMentions(message.text);
        message.isMinimized = false; // Start expanded
        
        // Also add to global movie recommendations if not already there
        if (message.mentionedMovies && message.mentionedMovies.length > 0) {
          message.mentionedMovies.forEach(movie => {
            const existingMovie = this.recommendedMovies.find(m => 
              m.title.toLowerCase() === movie.title.toLowerCase()
            );
            
            if (!existingMovie) {
              this.recommendedMovies.push({
                title: movie.title,
                recommendedBy: message.agentType,
                timestamp: new Date(),
                reason: movie.description
              });
            }
          });
        }
      }
      
      this.messages.push(message);
      
      // Scroll to the bottom
      this.$nextTick(() => {
        if (this.$refs.messagesContainer) {
          this.$refs.messagesContainer.scrollTop = this.$refs.messagesContainer.scrollHeight;
        }
      });
    },

    formatTime(timestamp) {
      return timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    },
    async finishConversation() {
      if (!this.canProceed) {
        return;
      }
      
      this.isSubmitting = true;
      
      try {
        // Log completion of second round
        await logUserEvent('second_round_completed', {
          messageCount: this.messages.length,
          userMessageCount: this.userMessageCount
        });
        
        // Navigate to final questionnaire
        this.$router.push({ name: 'FinalQuestionnaire' });
      } catch (error) {
        console.error('Error completing second round:', error);
        this.isSubmitting = false;
        alert('There was an error completing this round. Please try again.');
      }
    },
    // Build conversation history from previous messages
    buildConversationHistory() {
      // Limit to last 10 messages to avoid token limits
      const recentMessages = this.messages.slice(-10);
      return recentMessages.map(msg => {
        if (msg.sender === 'user') {
          return `User: ${msg.text}`;
        } else {
          return msg.text; // Agent messages already include their role
        }
      }).join('\n');
    },
    
    // Detect if user is responding to specific agents
    detectTargetedAgents(userMessage) {
      const lowerMessage = userMessage.toLowerCase();
      const targetedAgents = [];
      
      // Check if message contains agent role mentions with @ symbol
      for (const [agentKey, profile] of Object.entries(agentProfiles.agents)) {
        const roleLower = profile.role.toLowerCase();
        if (lowerMessage.includes(`@${roleLower}`)) {
          targetedAgents.push(agentKey);
        }
      }
      
      // If no direct mentions, check if responding to the last agent
      if (targetedAgents.length === 0 && this.messages.length > 0) {
        // Find the last agent message
        for (let i = this.messages.length - 1; i >= 0; i--) {
          if (this.messages[i].sender === 'agent') {
            const lastAgentMessage = this.messages[i];
            const agentType = lastAgentMessage.agentType;
            
            // Check if user is likely responding to the last agent
            const responseIndicators = ['yes', 'no', 'agree', 'disagree', 'why', 'what', 'how', 'tell me more'];
            const isDirectResponse = responseIndicators.some(indicator => lowerMessage.includes(indicator));
            
            // If it's a short message or contains response indicators, assume it's a response to the last agent
            if (isDirectResponse || (userMessage.length < 20 && !userMessage.includes('?'))) {
              targetedAgents.push(agentType);
            }
            
            break;
          }
        }
      }
      
      return targetedAgents;
    },
    
    // Legacy function for backward compatibility
    detectTargetedAgent(userMessage) {
      const agents = this.detectTargetedAgents(userMessage);
      return agents.length > 0 ? agents[0] : null;
    },
    
    // Get agent memories from localStorage
    getAgentMemories() {
      try {
        const memories = localStorage.getItem('agent_memories');
        return memories ? JSON.parse(memories) : {};
      } catch (error) {
        console.error('Error retrieving agent memories:', error);
        return {};
      }
    },
    
    // Update agent memory with new interaction
    updateAgentMemory(agentKey, userMessage, agentResponse) {
      try {
        const memories = this.getAgentMemories();
        
        // Initialize agent memory if it doesn't exist
        if (!memories[agentKey]) {
          memories[agentKey] = [];
        }
        
        // Add new interaction to memory
        memories[agentKey].push(`User: ${userMessage}\n${agentProfiles.agents[agentKey].role}: ${agentResponse}`);
        
        // Limit memory size (keep last 5 interactions)
        if (memories[agentKey].length > 5) {
          memories[agentKey] = memories[agentKey].slice(-5);
        }
        
        // Save updated memories
        localStorage.setItem('agent_memories', JSON.stringify(memories));
      } catch (error) {
        console.error('Error updating agent memory:', error);
      }
    },
    
    // Generate response where one agent responds to another
    async generateAgentToAgentResponse(conversationHistory, excludeAgents) {
      console.log('Starting generateAgentToAgentResponse...');
      console.log('Excluded agents:', excludeAgents);
      
      // Select a random agent that wasn't part of the current round
      const availableAgents = Object.keys(agentProfiles.agents)
        .filter(agent => !excludeAgents.includes(agent));
      
      console.log('Available agents for response:', availableAgents);
        
      if (availableAgents.length === 0) {
        console.log('No available agents to respond, returning');
        return;
      }
      
      const respondingAgentKey = availableAgents[Math.floor(Math.random() * availableAgents.length)];
      const respondingAgent = agentProfiles.agents[respondingAgentKey];
      console.log('Selected responding agent:', respondingAgentKey);
      
      this.isAgentTyping = true;
      
      try {
        const headers = {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${API_KEY}`
        };
        
        const prompt = 
          `${conversationHistory}\n\nAs a ${respondingAgent.role}, with expertise in ${respondingAgent.knowledge_domains.join(', ')}, join the ongoing conversation. Respond to what another participant just said, adding your unique perspective. Keep your response conversational and engaging.`;
        
        const data = {
          model: MODEL,
          messages: [{
            role: 'user',
            content: prompt
          }],
          max_tokens: 500
        };
        
        console.log(`Sending agent-to-agent API request for ${respondingAgentKey}...`);
        const response = await axios.post(`${BASE_URL}/chat/completions`, data, { headers, timeout: API_TIMEOUT });
        console.log(`Received agent-to-agent API response for ${respondingAgentKey}:`, response.status);
        const agentResponse = response.data.choices[0].message.content;
        
        // Check if the response already starts with the agent's role
        let displayText = '';
        if (agentResponse.startsWith(respondingAgent.role + ':') || 
            agentResponse.startsWith(respondingAgent.role + ' :')) {
          displayText = agentResponse;
        } else {
          displayText = `${respondingAgent.role}: ${agentResponse}`;
        }
        
        // Add the full message with the agent role if it was extracted
        this.addMessage({
          sender: 'agent',
          agentType: respondingAgentKey,
          text: displayText,
          timestamp: new Date(),
          isMinimized: false,
          mentionedMovies: this.extractMovieMentions(displayText)
        });
        
        // Log agent message to Firebase
        try {
          await logConversation('2', 'agent', agentResponse, respondingAgentKey);
        } catch (error) {
          console.warn('Failed to log agent message to Firebase:', error);
        }
      } catch (error) {
        console.error('Error generating agent-to-agent response:', error);
        if (error.response) {
          console.error('API error response:', error.response.status, error.response.data);
        } else if (error.request) {
          console.error('No response received from API:', error.request);
        } else {
          console.error('Error setting up API request:', error.message);
        }
      } finally {
        this.isAgentTyping = false;
        console.log('Agent-to-agent response process completed');
      }
    },
    getAgentAvatar(agentType) {
      const avatarMap = {
        'moderator': p1Image,
        'critic': p2Image,
        'fan': p3Image,
        'analyst': p4Image,
        'professional_critic': p2Image,
        'indie_enthusiast': p4Image,
        'blockbuster_fan': p3Image
      };
      
      return avatarMap[agentType] || p1Image; // Default to moderator avatar if type not found
    },
    replyToAgent(agentType, event) {
      // Get the clicked agent's role
      const agentRole = agentProfiles.agents[agentType].role;
      
      // Check if Shift key is pressed (for adding multiple agents)
      const isShiftPressed = event.shiftKey;
      
      // If Shift is pressed, append to existing @mentions
      if (isShiftPressed && this.userInput) {
        // Check if the agent is already mentioned
        if (!this.userInput.includes(`@${agentRole}`)) {
          this.userInput = this.userInput.trim() + ` @${agentRole} `;
        }
      } else {
        // Replace with new @mention
        this.userInput = `@${agentRole} `;
      }
      
      this.$refs.messageInput.focus();
    },
    setActiveAgent(agentKey) {
      this.activeAgent = agentKey;
      // Focus on the input field and add @ mention
      this.$refs.messageInput.focus();
      const agentRole = agentProfiles.agents[agentKey].role;
      this.userInput = `@${agentRole} `;
    },
    // Extract movie mentions from agent responses
    // Extract movie mentions from agent responses
    // Extract movie mentions from agent responses
    // Extract movie mentions from agent responses
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 首先检查是否是角色介绍
      if (text.match(/^I'?m (the|your|a) (moderator|agent|critic|fan|analyst|enthusiast|host)/i)) {
        return [];
      }
      
      // 检查是否是自我介绍或问候语
      if (text.match(/^(Welcome|Hello|Hi|Hey|Greetings|I'?m|I am)/i)) {
        // 检查自我介绍中是否明确提到电影
        if (!text.match(/\b(film|movie|cinema|documentary)\b/i)) {
          return [];
        }
      }
      
      // 特定的排除字符串
      const specificExclusions = [
        "m your moderator, and I",
        "m the Independent Film Enthusiast",
        "m the Professional Film Critic",
        "m the Blockbuster Fan",
        "m your host",
        "m here to",
        "m joined by",
        "m excited to"
      ];
      
      // 检查是否在特定排除列表中
      for (const exclusion of specificExclusions) {
        if (text.includes(exclusion)) {
          return [];
        }
      }
      
      // 其余的电影提取逻辑保持不变
      return this._extractMovieMentions(text);
    },
    
    // Generate a brief description for a mentioned movie
    generateBriefMovieDescription(text, movieTitle) {
      // Look for descriptions near the movie title
      const index = text.indexOf(movieTitle);
      if (index === -1) return "A film mentioned in conversation.";
      
      // Get text around the movie title (50 chars before and 100 chars after)
      const start = Math.max(0, index - 50);
      const end = Math.min(text.length, index + movieTitle.length + 100);
      const context = text.substring(start, end);
      
      // Look for descriptive phrases
      const descriptionPatterns = [
        new RegExp(`${movieTitle}[^.!?]{0,50}(?: is | as |, | - )([^.!?]{5,50})[.!?]`, 'i'),
        new RegExp(`${movieTitle}[^.!?]{0,20}(?: is | as |, | - )([^.!?]{5,50})[.!?]`, 'i'),
        new RegExp(`${movieTitle}[^.!?]{0,10}(?: is | as |, | - )([^.!?]{5,30})[.!?]`, 'i')
      ];
      
      for (const pattern of descriptionPatterns) {
        const match = context.match(pattern);
        if (match && match[1]) {
          return match[1].trim();
        }
      }
      
      // Fallback descriptions
      const fallbackDescriptions = [
        "A film worth exploring.",
        "An interesting cinematic work.",
        "A notable movie mentioned in our discussion.",
        "A film that came up in our conversation."
      ];
      
      return fallbackDescriptions[Math.floor(Math.random() * fallbackDescriptions.length)];
    },
    
    // Toggle message view between minimized and expanded
    toggleMessageView(messageIndex) {
      // Prevent event propagation to parent click handlers
      if (this.messages[messageIndex].sender === 'agent') {
        this.$set(this.messages[messageIndex], 'isMinimized', !this.messages[messageIndex].isMinimized);
      }
    },
    // 验证API密钥是否有效
    async validateApiKey() {
      try {
        console.log('Validating API key...');
        const headers = {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${API_KEY}`
        };
        
        const data = {
          model: MODEL,
          messages: [{
            role: 'user',
            content: 'Hello'
          }],
          max_tokens: 5
        };
        
        const response = await axios.post(`${BASE_URL}/chat/completions`, data, { 
          headers, 
          timeout: 10000 
        });
        
        if (response.data && response.data.choices && response.data.choices.length > 0) {
          console.log('API key is valid');
        } else {
          console.warn('API validation returned unexpected response:', response.data);
        }
      } catch (error) {
        console.error('API key validation failed:', error);
        console.error('Error details:', error.response ? error.response.data : 'No response data');
      }
    },
    // Extract movie mentions from agent responses
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // Patterns to identify movie mentions
      const moviePatterns = [
        /["']([^"']{2,50})["']/g, // Anything in quotes that could be a movie title
        /(?:film|movie|documentary) (?:called|titled) ["']([^"']{2,50})["']/gi,
        /(?:film|movie|documentary) ["']([^"']{2,50})["']/gi,
        /["']([^"']{2,50})["'] (?:film|movie|documentary)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // Skip if too short or already found
          if (movieTitle.length < 2 || mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // Generate a brief description
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    _____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              break;
            }
          }
          if (shouldExclude) continue;
          
          // 检查上下文是否包含电影关键词
          const contextStart = Math.max(0, match.index - 30);
          const contextEnd = Math.min(text.length, match.index + match[0].length + 30);
          const context = text.substring(contextStart, contextEnd).toLowerCase();
          
          const hasMovieKeyword = movieKeywords.some(keyword => context.includes(keyword));
          
          // 检查标题是否包含常见电影词汇
          const hasCommonMovieWord = commonMovieWords.some(word => 
            movieTitle.toLowerCase().includes(word)
          );
          
          // 如果既没有电影关键词也没有常见电影词汇，则跳过
          if (!hasMovieKeyword && !hasCommonMovieWord) {
            continue;
          }
          
          // 生成描述
          const description = this.generateBriefMovieDescription(text, movieTitle);
          
          mentionedMovies.push({
            title: movieTitle,
            description: description
          });
        }
      }
      
      return mentionedMovies;
    },
    // 内部方法，实际执行电影提取
    ______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________extractMovieMentions(text) {
      // 电影相关关键词
      const movieKeywords = ['film', 'movie', 'cinema', 'documentary', 'director', 'actor', 'actress', 
        'screenplay', 'plot', 'scene', 'character', 'award', 'oscar', 'genre', 'thriller', 'drama', 
        'comedy', 'action', 'sci-fi', 'horror', 'classic', 'blockbuster', 'indie', 'adaptation'];
      
      // 常见电影词汇
      const commonMovieWords = ['the', 'of', 'and', 'in', 'on', 'to', 'a', 'day', 'night', 'man', 
        'woman', 'life', 'death', 'love', 'time', 'world', 'house', 'city', 'star', 'dark', 'light', 
        'black', 'white', 'red', 'blue', 'green', 'last', 'first', 'new', 'old'];
      
      // 排除的模式
      const exclusionPatterns = [
        /^(I'?m|I am|you'?re|you are|he'?s|she'?s|they'?re|we'?re)\b/i,
        /^(hello|hi|hey|greetings|welcome)/i,
        /^(yes|no|maybe|certainly|definitely|absolutely)/i,
        /^(thank|thanks)/i,
        /^(sorry|apologize)/i,
        /^(please|kindly)/i,
        /^(your|my|his|her|their|our)\b/i,
        /^(this|that|these|those)\b/i,
        /^(a|an|the)\b/i,
        /^(as|if|when|while|because)\b/i,
        /^(to|for|from|with|by|about)\b/i,
        /\b(moderator|agent|critic|fan|analyst|enthusiast)\b/i,
        /^.{1,3}$/
      ];
      
      // 更精确的电影引用模式
      const moviePatterns = [
        /(?:film|movie|documentary|watch|saw|seen|watching|recommend|favorite|enjoyed) (?:called|titled|named)? ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:film|movie|documentary|is about|tells the story|directed by|starring)/gi,
        /(?:watch|saw|seen|recommend|like|love|enjoy|favorite) ["']([^"']{3,50})["']/gi,
        /["']([^"']{3,50})["'] (?:is a great|is an excellent|is a classic|is a must-see|is a wonderful)/gi
      ];
      
      const mentionedMovies = [];
      let match;
      
      for (const pattern of moviePatterns) {
        // Reset the regex for each pattern
        pattern.lastIndex = 0;
        
        while ((match = pattern.exec(text)) !== null) {
          const movieTitle = match[1].trim();
          
          // 跳过已经找到的电影
          if (mentionedMovies.some(m => m.title.toLowerCase() === movieTitle.toLowerCase())) {
            continue;
          }
          
          // 跳过太短的标题
          if (movieTitle.length < 3) {
            continue;
          }
          
          // 检查是否匹配排除模式
          let shouldExclude = false;
          for (const exPattern of exclusionPatterns) {
            if (exPattern.test(movieTitle)) {
              shouldExclude = true;
              bre